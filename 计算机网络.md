###  计算机网络

[计算机网络知识点整理 - dear_diary - 博客园 (cnblogs.com)](https://www.cnblogs.com/dear_diary/p/10339776.html)

1.物理层 

编码与调制，传输方式(电路，报文 存储转发，分组)，设备(中继器 信号再生，集线器)

2.数据链路层 

组帧(字符计数法，首尾定界法，违规编码法)，加上首部和尾部，首部是让帧能够被相应的目的主机接收，尾部是让目的主机检查帧是否有误码，             差错控制(检错编码，纠错编码)，

流量控制(停止等待协议，后退N帧协议，选择重传协议)，    可靠传输(确认和超时重传机制)， 

介质访问(1信道划分介质访问控制(频/时/波/码分复用)，      2 随机访问介质访问控制(CSMA/CD 先听再法，边听边法，碰撞停发，随机重发))，               局域网(一种广播信道，无连接 数据链路层可再拆分为MAC子层，LLC子层)， 以太网(总线型)，     网卡(网络适配器，工作在数据链路层，MAC介质访问控制地址， 电脑一般两个网卡，有线和无线)，  虚拟局域网(隔离广播域，插入VLAM标记，交换机处理)

广播域(通信子网下三层) PPP(面向字节，不可靠)            交换机(可以实现VLAN，即隔离冲突域，又隔离广播域， 总带宽会随着端口结点的增加而增加)

交换机比集线器提供更好的网络性能的原因是交换机支持对多用户同时通信，MAC(Medium介质访问控制，组帧和介质访问)，一个网卡(网络适配器)对应一个MAC地址; 扩大了广播域，隔离了碰撞域(碰撞后会缓存然后逐个转发给目的主机)

3.网络层

争论是否由网路层提供面向连接服务，结果是尽最大努力交付(OSI理想地提出应该提供两种服务)

路由算法，  流量控制(发送接收端点到点)和拥赛控制(全局，开环控制 静态，闭环控制 动态)

层次路由，路由选择，网络地址转换(NAT )    

IPV4(子网划分，无分类编址(/20))     ABC类：0，10，110 网络号，子网号，主机号

协议：ARP(地址解析协议，请求广播，回应单播，通信过程中IP源目的地址保持不变，MAC地址随着链路改变而改变)      DHCP动态主机配置协议(应用层，UDP),  ICMP(IP层协议  网际控制报文协议 分为差错报告报文(终点不可达，源点抑制)， 和询问报文)       

IPV6(解决IPV4地址耗尽,不允许分片(只在包的源结点才分片))  

协议(RIP,OSPF, BGP) 跳数代价非最优，UDP, IP, TCP

RIP(Routing Information Protocol)：使用跳数衡量距离，最多包含15个路由器，和相邻的路由器周期性交换自己全部的路由表；坏消息传得慢，限制网络规模，完整路由表开销大

OSPF(Open shortest Path First)开放路径最短优先：基于链路状态(和哪些路由器相连，相应链路的代价)；不限制网络规模，收敛速度块

BGP(Border Gateway Protocol)边界网关协议：非最佳，BGP发言人交换路由信息(改了的)，网络可达性信息，找出非最佳

IP组播， 移动IP, 路由器

4.传输层

MAC –>IP –> 端口   提供服务: 进程间通信，复用和分用，差错检测，TCP和UDP

UDP：面向报文(不可分割),首部：源端口号，目的端口号，长度(包括首部和数据部分的长度)，校验和

校验机制：采用首部，伪首部(IP,UDP长度)，数据进行二进制反码运算求和再运算

TCP：面向字节流，有连接，一对一，提供可靠交付，全双工通信     可靠传输机制：序号,确认,重传

流量控制(防止接收方缓存区溢出)：rwbd(接收窗口)：接收方根据自己接收缓存的大小，动态调整发送方的发送窗口大小；  cwnd(拥赛窗口)：发送方根据其对当前网络拥塞的估计确定窗口值

拥塞控制：慢开始，拥塞避免，快重传，快恢复

5.应用层

解决通过应用进程的交互来实现特定网络应用的问题

网络应用模型：客户/服务器(C/S)方式，对等(P2P)方式

1域名系统DNS  顶级二级三级四级域名  域名服务器：本地域名，授权域名，顶级域名，根域名服务器

域名解析过程：递归查询，迭代查询(由于递归对被查询的域名服务器负担太大，通常采用请求主机到本地是递归，其他是迭代)， 高速缓存(一段时间后丢弃)

2文件传输协议(FTP)  提供交互式的访问，允许客户指明文件的类型与格式，允许文件由存取权限

FTP客户与服务器之间要建立两个并行的TCP连接(控制连接，命令连接 分为主动模式(端口为21,20）和被动模式)

3电子邮件E-mail  组成：用户代理(接口)，邮件服务器，邮件发送协议和读取协议(SMTP,POP3)

简单邮件传输协议SMTP(14条命令，21条应答)  仅限传送7位ASCII码

邮局协议POP3        多用途网际邮件扩充MIME：解决SMTP传送非ASCII码的问题

基于万维网的电子邮件:  在同一邮件服务器之间都使用HTTP，不同邮件服务器之间使用SMTP

4万维网WWW:  资料空间，资源由URL表示，通过HTTP传送给使用者      URL(协议//主机：端口/路径)

Web用户使用URL与服务器建立连接，Web服务器把URL转换为文件路径，并返回信息给浏览器

HTTP: 1.0采用非持续连接方式，1.1采用持续连接方式，还可以使用流水线方式

HTTP的报文结构:  面向文本的，报文中的每一个字段都是ASCII码，并且长度不固定，分为请求报文和响应报文

Cookie：记住用户，是一种对无状态的HTTP进行状态化的技术

万维网缓存与代理技术：

#### 面试小抄

1. ISO七层协议：对话层，表示层；  TCP/IP四层协议：网络接口层，网际层，运输层，应用层

2. ISO/OSI参考模型在网络层支持无连接和面向连接的通信，但在传输层仅支持面向连接的通信；

   TCP/IP模型在网络层仅有无连接的通信，而在传输层支持无连接和面向连接的通信

3. HTTP报文，TCP报文段/UDP数据报，IP数据报，帧，比特流

4. UDP：无连接，不可靠，不提供流量控制和拥塞控制，无序，不止一对一，面向报文，首部开销小

5. TCP常用于FTP文件传输，HTTP/HTTPS；UDP实时应用(视频音频等多媒体通信)，或者包总量较少的通信，如DNS域名转换，SNMP网络管理

6. TCP三次握手：第一次握手，客户端发送一个同步报文(SYN=1)，同时选择一个随机数seq=x作为初始序列号，进入SYN_SENT状态；  第二次握手：服务端发送同步确认报文(SYN=1, ACK=1)，确认号为ack=x+1；初始序列号seq=y，进入SYN_RECV;   第三次握手：客户端发送确认报文(ACK=1),确认号为ack=y+1，序列号为seq=x+1，客户端和服务端进入ESTABLISHED状态，完成三次握手

7. 为什么不是两次：1防止已过期的连接请求突然又传送到服务器(传输结束断开后)，产生错误和资源浪费；2三次握手才能让双方确认自己和对方的发送和接收能力都正常；3告知对方的初始序列号值，并确认收到对方的初始序列号值(TCP的可靠传输)

8. 为什么不是四次：三次握手已经可以确定双方的发送接收能力正常，双方都知道彼此已经准备好，而且也可以完成对双方初始序号值得确认

9. TCP四次挥手：第一次挥手：客户端FIN=1;  第二次挥手：服务端ACK=1，完成剩余数据传输;  第三次挥手：服务端FIN=1, ACK=1;  第四次挥手：客户端ACK=1;  服务端直接关闭，客户端还要time-wait状态，经过一段时间后才closed

10. TCP没有IP数据报的标志和片偏移，直接通过序列号和确认号保证解决乱序问题

11. 客户端分别是fin_wait_1,  fin_wait_2,  time_wait状态，客户端是closed_wait,  last_ack,  closed

12. 为什么连接是三次，关闭是四次：第一次挥手受到FIN=1时，服务端可能还有一些数据要传输，不能马上关闭连接，但是会做出应答返回ACK=1；所以服务端ACK和FIN是分开发送的，所以多了一次

13. 为什么客户端time_wait状态要等待2MSL：1确认ACK报文能够到达服务端，是服务端正常关闭连接；2防止已失效的连接请求报文段出现在之后的连接中

14. TCP如何保证可靠性：1校验和；2序列号/确认应答(seq/ack)；3滑动窗口；4超时重传；5拥塞控制；6流量控制

15. TCP滑动窗口：窗口大小指的是不需要确认应答而可以继续发送数据包的最大值，起到一个限流作用，决定了当前TCP发送包的速率，大小是拥塞控制窗口和流量控制窗口的最小值

16. 拥塞控制：慢开始，拥塞避免(拥塞窗口大小慢慢增长，加法增大，乘法减小)，快重传，快恢复

17. 快重传：接收方在收到一个失序的报文段后就立即发出重复确认，而不要等到自己发送数据时捎带确认。快重传规定：发送方只要一连收到三个重复确认就应当立即重传对方尚未收到的报文段，而不必继续等待设置的重传计时器时间到期

18. 快恢复：主要是配合快重传。当发送方连续收到三个重复确认时，就执行“乘法减小”算法，把ssthresh门限减半（为了预防网络发生拥塞），但接下来并不执行慢开始算法，因为如果网络出现拥塞的话就不会收到好几个重复的确认，收到三个重复确认说明网络状况还可以。

19. 常见状态码：200成功；(300重定向)301永久移动，302临时移动；400客户端请求语法错误，404服务器找不到请求的网页；500服务器错误，无法完成请求

20. get和post请求的区别:本质区别，get请求是幂等性的(对用一URL的多个请求应该返回同样的结果)

21. HTTP1.0和1.1的区别：1长连接，一个TCP连接上可以传送多个HTTP请求和响应(1.0每次请求都要创建新连接)；2缓存处理；3带宽优化及网络连接的使用(1.1在请求头引入range头域，允许只请求资源的某个部分)；4错误通知的管理(新增了错误状态响应码)；5Host头处理(一个服务器可能存在多个虚拟主机，请求和响应消息都会携带主机名hostname)

22. HTTP1.1和HTTP2.0的区别：1新的二进制格式(之前是文本)；2多路复用(每一个request都是用作连接共享机制的)；3头部压缩(缓存header fields表)；4服务端推送(服务端可以额外向客户端推送资源)

23. HTTP1.1和HTTP2.0的区别：1使用二进制格式而不是文本格式来传输数据，解析更加高效；2多路复用，一个TCP连接上可以同时进行多个HTTP请求/响应，解决了1.0的对头阻塞问题；3头部压缩，HTTP协议不带状态，所以每次请求都必须附上所有信息，2.0引入了头部压缩机制，可以使用gzip或者compress压缩后发送，减少了冗余头部信息带来的带宽消耗；4服务器端推送，服务器可以主动向客户端推送资源，而不需要客户端明确请求

24. HTTP2.0和3.0的区别：1  2.0基于TCP协议，3.0基于QUIC协议，直译为快速UDP网络连接；2基于TCP的2.0尽管从逻辑上来说，不同流之间相互独立不会互相影响，但在实际传输过程中，一旦某一个流的数据有丢包，仍然会阻塞在它之后传输的流数据；   而基于UDP的QUIC协议可以更彻底地解决这样的问题，让不同流之间真正的实现相互独立传输，互不干扰；3QUIC协议在传输的过程中就完成了TLS加密握手，更直接了

25. HTTP1.0默认短连接，1.1默认长连接，2.0采用多路复用

26. HTTP与HTTPS的区别：

    |              | HTTP               | HTTPS                                   |
    | ------------ | ------------------ | --------------------------------------- |
    | 端口         | 80                 | 443                                     |
    | 安全性       | 无加密，安全性较差 | 有加密机制，安全性较高                  |
    | 资源消耗     | 较少               | 由于加密处理，资源消耗更多              |
    | 是否需要证书 | 不需要             | 需要                                    |
    | 协议         | 运行在TCP协议之上  | 运行在SSL协议之上，SSL运行在TCP协议之上 |

27. HTTPS原理：1请求；2响应，会携带数字证书(证书包含公钥A)，私钥服务器自己保存；3客户端取出公钥生成随机码KEY，并使用公钥A加密KEY；4发送加密后的随机码KEY，作为接下来对称加密的密钥；5用私钥B解密KEY，使用KEY对传输数据进行对称加密；5客户端使用KEY解密数据；6通过对称加密传输所有内容

28. 从输入URL到页面展示发生了什么：1先检查浏览器缓存里是否有缓存该资源；2DNS解析，获取IP地址；3建立TCP连接；4请求响应；5解析响应头，选择重定向/如果是字节流类型会交给下载管理器，或者HTML渲染流程；6解析HTML，创建DOM树，解析CSS并合并，构建渲染树，最后布局和绘制渲染树，完成页面展示

29. 1域名解析；2建立tcp连接；3请求响应；4解析html；5对页面进行渲染

30. Session 代表着服务器和客户端一次会话的过程。Session 对象存储特定用户会话所需的属性及配置信息，当客户端关闭会话或者Session超时失效时会话结束

31. Cookie和Session如何配合：通过SessionID查找对应的Session，以此验证用户的登录状态

32. DNS域名解析：分为根域名服务器，顶级域DNS服务器(com)，权威DNS服务器(server.com)

33. 流程：浏览器首先检查自己的缓存，操作系统的缓存和本机域名解析文件hosts，都没有就会DNS服务器解析查询；    将DNS请求发送给本地DNS服务器查看DNS缓存，没有的话，依次询问根域名服务器，顶级域名服务器，权威域名服务器，最终返回查询到的IP地址





























1.计算机网络体系结构

数据链路层：链路中多个主机传输数据，考虑MAC地址、成帧、协调各主机争夺总线(碰撞问题)

成帧，差错控制，流量控制(相邻结点间)，信道访问控制，不具有拥塞控制，PPP,CSMA/DA

网络层：实现网络间数据传输，考虑IP地址，路由选择，分组转发问题

路由选择，差错控制，流量控制(整个网络)，拥塞控制，IP，ARP, NAT, ICMP, IGMP, OSPF

运输层：进程之间通信问题，考虑通信问题，传输错误处理问题

端到端运输，差错控制，流量控制(端到端)，分时复用  TCP, UDP

会话层：进程之间会话问题，

表示层：通信双方交换信息的表示问题，   数据格式变换，加密解密，压缩和恢复

应用层：应用进程之间的相互交互



1.数据链路层

封装成帧，差错控制(纠错编码和检错编码)，流量控制与可靠传输机制(停止等待协议，回退N帧协议，选择重传协议)，媒体接入控制(动态：CSMA/CD和静态信道划分：频分)，以太网，虚拟局域网

2.数据层

IP数据报，IPV4(子网划分，无分类编址，定长/变长子网编码，NAT)，路由算法(RIP,OSPF,BGP，跳数最少，代价最少，较好非最佳)，ARP(IP找MAC), DHCP(动态分配IP), ICMP(差错报告：终点不可达，源点抑制)， IPV6, IP组播(IGMP组播路由算法), 移动IP， 路由器，冲突域和广播域





































1.1 概述

组成：从组成部分看(硬件，软件，协议)； 从工作方式看(边缘部分 主机，核心部分 网络和路由器)；从功能看(通信子网 资源子网)

功能：数据通信, 资源共享，分布式处理，提高可靠性，负载均衡

分类：按分布范围分类(个人局域网，局域网，城域网，广域网)；按传输技术分类(广播式网络，点对点网络)；按拓扑结构分类()；按交换技术分类(电路交换网络，报文，分组)；按传输介质(有线无线)

性能指标：时延，吞吐量(网络或者接口)，速率(主机)，最高速率称为带宽，时延带宽积

1.2 结构

协议(语法，语义，同步；同一层)，接口，服务(面向连接服务与无连接服务，可靠服务与不可靠服务，有应答服务与无应答服务；下层为上层)

ISO/OSI模型

物理层(传输单位是比特，传输比特流)；数据链路层(传输单位是帧，任务是将网络层传来的IP数据报组装成帧)；网络层(传输单位是数据报，面向主机提供通信服务)；传输层(传输单位是报文段或用户数据报，面向两个进程间的通信)；会话层(不同主机上的各个进程之间进行对话)；表示层(处理两个通信系统中交换信息的表示方式，有数据表示变换功能)；应用层(用户与网络界面)

TCP/IP模型

网络接口层，网际层，传输层，应用层

不同：OSI在网络层支持无连接和面向连接的通信，但在传输层仅有面向连接的通信；TCP/IP在网际层仅有一种无连接的通信模式，但在传输层支持无连接和面向连接两种模式

交换： 电路交换：通信时延迟小，有序传输，没有冲突   预先建立一条专用的物理通信线路

报文交换： 数据交换的单位是报文，采用存储转发的传输方式，无需建立连接，动态分配线路，提高线路可靠性，提高线路利用率   转发时延，需要比较大的缓冲空间

分组交换：限制数据块的大小，其他同报文  减少出错概率和重发数据量，需要传输额外的信息量(地址信息)，可能会出现失序丢失或重复分组；  可分为面向连接的虚电路方式和无连接的数据报方式

数据报：在网络层加上地址等控制信息后形成的数据报分组，根据各分组不同的最佳路由，可以走不同的路径，也可以按照不同的顺序到达目的节点

虚电路：将数据报方式和电路交换结合，在分组发送之前需要建立一条逻辑上相连的虚电路且固定，三个阶段：虚电路建立，数据传输和虚电路释放

2物理层

奈奎斯特定理：理想低通信道无噪声(信号传输媒介)，码元(一位k进制波形)传输速率是有上限的

香农定理：对带宽受限和一定的信噪比，信息传输速率的上限是确定的，当传输速率低于极限传输速率时就能实现无差错的传输，低于奈奎斯特

编码和调制

传输介质：双绞线， 光纤， 无线

信道复用技术：频分多路复用(将多路基带信号调制到不同频率载波上)； 时分多路复用(将一条物理信道按时间分成若干时间片) ；  波分多路复用(在一根光纤中传输不同频率的光信号)； 码分多路复用(采用不同的编码来区分各路原始信号的复用方式，合并再分解)

物理层设备：中继器(将信号整形并放大，扩大网络传输的距离，原理是信号再生)；集线器(Hub)：多端口的中继器，如果同时多个端口输入，则输出时会发送冲突导致数据无效



3.数据链路层

提供相邻结点的可靠数据传输

组帧  字符计数法  字符填充的首位定界符法  零比特填充的首尾标志法0111110  违规编码法

检错编码  奇偶校验码  循环冗余码  纠错编码(海明码)    +  透明传输   三个基本问题

流量控制与可靠传输机制  滑动窗口机制(等待应答)   1停止-等待流量控制基本原理(一帧)  2多帧滑动窗口与后退N帧协议  3多帧滑动窗口与选择重传协议(不后退，直接重传丢失帧) (接收窗口+发送窗口<=2**BYTE)

信道划分介质访问控制  

介质访问协议  ALOHA协议(不进行任何检测就发送数据，再等待一段时间)   CSMA协议(帧听信道是否空闲or忙，分为坚持or不坚持)      CSMA/CD协议 先听后发，边听边发，冲突停发，随机重发(2t争用期，端到端传播时延的2倍；所有数据帧必须大于最小帧长=2t*数据传输速率)  令牌传递协议

 局域网：拓扑结构，主流传输介质为双绞线，介质访问控制方法：CSMA/CD，令牌总线(总线型)，令牌环(环形)       几种不同局域网：以太网(总线型拓扑结构，广播，CSMA/CD，符合xx标准，采用无连接工作方式，不对数据帧编号，不要求确认，不可靠服务，曼彻斯特编码) 

现在的以太网基于交换机和全双工连接不会有碰撞，不需要使用CSMA/CD

网卡(网络适配器)，MAC地址(介质访问控制，用于控制主机在网络上的数据通信，6字节)，数据最小为64-6-6-2=46字节，需要填充)

广域网(路由选择和分组转发)，数据链路层控制协议(大部分协议在网络层): PPP协议，HDLC协议

网桥(连接多个以太网(网段)，工作在链路层的MAC子层，使得各网段成为隔离开的碰撞域)；交换机

交换机可以隔离碰撞域，集线器会合并，但是也会扩大广播域，使用路由器可以隔离广播域(贵，所以使用虚拟局域网)



3.网络层

路由器功能(路由选择(确定哪一条路径)，分组转发)， 拥赛控制      路由算法

IPV4: IP数据报=首部+数据部分  首部：首部长度(单位4B，数据报的总长度不能超过1500B) ，总长度(单位字节)，  标识(每产生一个数据报就加1，超过数据链路层MTU时分片) ， 标志(分片相关，MF=1还有分片，DF=0允许分片) ，  分片偏移(8字节为偏移单位)

IP地址=网络号+主机号   主机号全为零表示本网络本身，主机号全为1表示本网络的广播地址

网络地址转换(NAT)：将专用网络地址转换为公用地址，对外隐藏内部管理的IP地址，NAT路由器至少有一个有效的外部全球地址

子网划分：内部的事情  ，有对应的子网掩码(子网号+主机号) ，CIDR类似子网掩码

ARP地址解析协议(根据IP找MAC),   DHCP动态主机配置协议(给主机动态分配IP地址，应用层协议，基于UDP),    ICMP网际控制报文协议(用于向源主机报告差错和异常情况，终点不可达，源点抑制(拥塞丢弃数据报)，时间超过)  

IPV6  只有在包的源节点才能分片，端到端，传输路径中的路由器不能分片，首部长度(单位8B)

RIP路由信息协议(每个路由器都要维护自身到其他每个目的网路距离记录，认为好的路由就是它通过的路由器的数目少，最多允许15跳)：仅和相邻路由器交换信息(全部信息)，按固定时间交换路由信息

距离向量算法: 类似求最短路径 ，网络出现故障时会出现慢收敛现象

OSPF开放最短路径优先协议，当链路状态发生变化时，用洪泛法向所有路由器发送信息，更新过程收敛快，网络层协议

BGP边界网关协议:力求比较好的路由(不能兜圈子)，采用路径向量路由选择协议，应用层协议，基于TCP   三个协议的路径选择分别是跳数最少，代价最低，非最佳

IP组播：两种，在本局域网上进行的硬件组播，在因特网的范围内进行组播

移动IP 三种功能实体：移动结点，本地代理，外部代理



4.传输层